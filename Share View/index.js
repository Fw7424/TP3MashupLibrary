/*! v3.0.12 Build Thu Dec 21 2017 15:52:56 GMT+0300 (+03) */
!function(){var mashup={},define=function(){var t,e,n,a=Array.prototype.slice.call(arguments,0);"string"==typeof a[0]?(n=a[0],t=a[1],e=a[2]):Array.isArray(a[0])&&(t=a[0],e=a[1]);var r=t.reduce(function(t,e){return t.addDependency(e)},tau.mashups);return r=r.addDependency(n+"/config"),r=r.addMashup(function(){var a=Array.prototype.slice.call(arguments,0);if(t.length>0&&1===a.length)throw new Error("Can't properly load dependencies for mashup \""+n+'", mashup is stopped.');return mashup.variables=a[a.length-1],a.length-t.length===2?mashup.config=a[a.length-2]:mashup.config={},Object.freeze&&(Object.freeze(mashup.variables),Object.freeze(mashup.config),Object.freeze(mashup)),e.apply(null,a)})};define("ShareBoard",["Underscore","jQuery","tau/configurator","app.path","tau/init.points/init.points"],function(__WEBPACK_EXTERNAL_MODULE_4__,__WEBPACK_EXTERNAL_MODULE_5__,__WEBPACK_EXTERNAL_MODULE_6__,__WEBPACK_EXTERNAL_MODULE_7__,__WEBPACK_EXTERNAL_MODULE_13__){return function(t){function e(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e.p=mashup.variables?mashup.variables.mashupPath:e.p,e(0)}([function(t,e,n){t.exports=n(3)},,,function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){var n=[],a=!0,r=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(a=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);a=!0);}catch(t){r=!0,o=t}finally{try{!a&&u["return"]&&u["return"]()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(t,e,n){for(var a=!0;a;){var r=t,o=e,i=n;a=!1,null===r&&(r=Function.prototype);var u=Object.getOwnPropertyDescriptor(r,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(i)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=i,a=!0,u=l=void 0}},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),l=n(4),d=a(l),c=n(5),p=a(c),h=n(6),f=a(h),b=n(7),_=a(b),v=n(8),y=a(v),g=n(9),m=a(g),x=n(10),w=a(x),j=n(11),k=a(j),E=n(12),S=a(E),O=n(13),A=a(O);n(14);var C,T,D,L,R,P=mashup.config,U=P.serviceUrl,B=P.title||"Share %s",N=P.newActionsListVersion,z="tauboard_user_shares_"+(window.loggedUser||{id:0}).id,M=f["default"].getBusRegistry(),K=f["default"].getGlobalBus(),I=f["default"].getRestStorage(),W=f["default"].getLoggedUser(),X=f["default"].getSystemInfo(),F=_["default"].get(),V=function(t){try{return JSON.parse(window.localStorage.getItem(t))}catch(t){return}},J=function(t,e){window.localStorage.setItem(t,JSON.stringify(e))},$=function(t){return function(){t.apply(null,d["default"].rest(d["default"].toArray(arguments)))}},G=function(t,e,n){M.on("create",$(function(a){var r=a.bus;r.name===t&&r.on(e,n)})),M.on("destroy",$(function(a){var r=a.bus;r.name===t&&r.removeListener(e,n)}))},H=function(){if(T.id)return T.id},Y=function(){if(C&&T.id)return T.id+"_"+C},Z=A["default"].ajaxIdle.then(function(){return p["default"].ajax({type:"GET",url:f["default"].getApplicationPath()+"/api/v1/authentication?format=json"}).then(function(t){return t.Token})}),Q=function(){return window.VZDRP_PATH_TO_VIZYDROP||""+F+X.vizydropUri},q=function(t,e){var n=f["default"].getApplicationPath(),a=Q();return a+"/api/v1/drops/"+t+"/sharing?service=targetprocess&host="+n+"&token="+e},tt=function(t,e){return Q()+"/shared/drop/"+t+"?authkey="+e},et=function(){return p["default"].when(Z).then(function(t){if("reportWithVizydrop"===L){var e=q(T.link,t);return p["default"].ajax({method:"POST",url:e,xhrFields:{withCredentials:!0}}).then(function(t){return{dropId:t.id,dropSharingKey:t.sharingKey,shareType:"vizydrop"}})}var n={"tick":Date.now(),"serviceUrl":U,"boardId":T.id,"viewType":L,"acid":C,"title":document.title,"system":window.tauSystemInfo||{},"token":t,"host":f["default"].getApplicationPath(),"user":W||{id:0},viewportSize:{width:window.innerWidth,height:window.innerHeight},useContact:(0,p["default"])("[name=useContact]").is(":checked")};return p["default"].ajax({method:"POST",url:U+"/capture/",data:JSON.stringify(n),contentType:"application/json",processData:!1,dataType:"json"}).then(function(t){return{url:t.url,shareType:"tauboard"}})}).then(function(t){var e=H(),n=document.title;return d["default"].extend(t,{title:n}),I.data(z,e,t)})},nt=function(t,e,n){var a=function(){return I.remove(z,{$key:t})};return p["default"].when(Z).then(function(t){return"vizydrop"===n?p["default"].ajax({method:"DELETE",url:q(e,t),xhrFields:{withCredentials:!0}}):p["default"].ajax({method:"POST",url:U+"/stop/"+e,data:JSON.stringify({"token":t}),contentType:"application/json",processData:!1,dataType:"json"})}).then(a,a)},at=function t(e){var n=V("isUseContactChecked");return n=n!==!1||n,p["default"].when(H()).then(function(t){return p["default"].when(I.data(z,t),t)}).then(function(t,e){if(!t.value){var n=Y();return p["default"].when(I.data(z,n),n)}return p["default"].when(t,e)}).then(function(t,e){return(0,p["default"])((0,y["default"])({share:it.create(t.value),key:e,isUseContactChecked:Boolean(n)}))}).then(function(n){return n.on("click",".i-role-remove-share",function(n){n.stopPropagation(),n.preventDefault();var a=(0,p["default"])(this).data("key"),r=(0,p["default"])(this).data("share-id"),o=(0,p["default"])(this).data("share-type");nt(a,r,o).then(function(){return t(e)})}),n.on("click",".i-role-create-share",function(n){n.stopPropagation(),n.preventDefault(),(0,p["default"])(n.target).attr("disabled","disabled"),et().then(function(){return t(e)})}),n.on("click",".i-role-manage-shares",function(t){return t.stopPropagation(),t.preventDefault(),rt(e)}),n.on("click","[name=useContact]",function(t){J("isUseContactChecked",Boolean((0,p["default"])(this).prop("checked")))}),n}).then(function(t){return e.html(t),t})},rt=function t(e){return I.select(z,{$where:{scope:"private"},$fields:["key","userData.url AS url","userData.dropId AS dropId","userData.shareType AS shareType","userData.dropSharingKey AS dropSharingKey","userData.title AS title"]}).then(function(t){return(0,p["default"])((0,m["default"])({shares:d["default"].map(t.data,function(t){return it.create(t)})}))}).then(function(n){return n.on("click",".i-role-remove-share",function(n){n.stopPropagation(),n.preventDefault(),(0,p["default"])(n.target).parents("li:first").css("opacity",.5),(0,p["default"])(n.target).remove();var a=(0,p["default"])(this).data("key"),r=(0,p["default"])(this).data("share-id"),o=(0,p["default"])(this).data("share-type");nt(a,r,o).then(function(){return t(e)})}),n.on("click",".i-role-current-share",function(t){return t.stopPropagation(),t.preventDefault(),at(e)}),n}).then(function(t){e.html(t)})},ot=function(t,e){if(!window.tauDisableShareView){var n=dt(e);P.removeOld&&setTimeout(function(){t.find('[class="tau-board-actions-item share-board-action"]').remove()},100);var a={"newlist":"list","reportWithVizydrop":"report"}[R||L],r=d["default"].sprintf(B,a||R||L),o=(0,p["default"])(n({title:r})),i=ct(t);i.append(o);var u=(0,p["default"])("<div />");at(u);var s=o.is(".i-role-share-board")?o:o.find(".i-role-share-board");s.tauBubble({className:"tau-share-board-bubble",content:u,onPositionConfig:function(t){t.at="center bottom",t.my="center top"},onShow:function(t){t.css("z-index",1e3),(0,p["default"])(".tau-in-text",t).focus().select()}})}},it=function(){function t(e){o(this,t),this.shareData=e}return s(t,[{key:"shareType",get:function(){return this.shareData.shareType}},{key:"title",get:function(){return this.shareData.title}},{key:"key",get:function(){return this.shareData.key}}],[{key:"create",value:function(t){return t?"vizydrop"===t.shareType?new st(t):new ut(t):null}}]),t}(),ut=function(t){function e(){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),s(e,[{key:"id",get:function(){return this.shareData.url}},{key:"url",get:function(){return U+"/v/"+this.shareData.url}}]),e}(it),st=function(t){function e(){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,t),s(e,[{key:"id",get:function(){return this.shareData.dropId}},{key:"url",get:function(){return tt(this.shareData.dropId,this.shareData.dropSharingKey)}}]),e}(it),lt=function(){var t=X.version.split(".").map(Number),e=i(t,3),n=e[0],a=e[1],r=e[2],o=N.split(".").map(Number),u=i(o,3),s=u[0],l=u[1],d=u[2],c=n==s&&a==l&&r==d,p=n==s&&a==l&&r>d,h=n==s&&a>l,f=n>s;return c||p||h||f}(),dt=function(t){return t?S["default"]:lt?k["default"]:w["default"]},ct=function(t){if(lt){var e=t.find(".i-role-additional-actions-group");return 1==e.length?e:t}return t},pt=function(t){ot(t,!0)};K.on("application.context.data",function(t,e){D=e}),K.on("actualAcid.ready",function(t,e){C=e}),G("board_plus","boardSettings.ready",function(t,e){T=e.boardSettings.settings,L="board",R=e.boardSettings.settings.viewMode}),G("newlist","boardSettings.ready",function(t,e){T=e.boardSettings.settings,L="board",R=e.boardSettings.settings.viewMode}),G("dashboard.toolbar","boardSettings.ready",function(t,e){T=e.boardSettings.settings,L="dashboard",R=null}),G("customReport","boardSettings.ready",function(t,e){T=e.boardSettings.settings,L="report",R=null}),G("customReportContainer","boardSettings.ready",function(t,e){T=e.boardSettings.settings,L=T.isExternal?"reportWithVizydrop":"report",R=null}),W.isAdministrator||G("dashboard.toolbar","afterRender",function(t,e){L="dashboard",R=null;var n=e.element;n.find(".tau-actions-btn").length||pt(n)}),G("dashboard-actions-bubble","afterRender",function(t,e){L="dashboard",R=null,ot(e.element)}),G("report-actions-bubble","afterRender",function(t,e){R=null,(f["default"].getBoardAccessService().isEditable(T,W)||T.isExternal!==!0)&&ot(e.element)}),G("actions-bubble","afterRenderAll",function(t,e){var n=["board","timeline","newlist"],a=n.indexOf(R)>=0;a&&ot(e.element)})},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_4__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_5__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_6__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_7__},function(module,exports){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="tau-share-content">\n    ',share||(__p+='\n        <div class="tau-share-content__control">\n            <button type="button" class="tau-btn tau-board-new-share i-role-create-share">Share this view</button>\n        </div>\n        <span class="tau-txt tau-board-new-share">with anyone</span>\n    '),__p+="\n    ",share&&(__p+='\n        <textarea class="tau-in-text tau-existing-share" readonly="readonly">'+(null==(__t=share.url)?"":__t)+'</textarea>\n\n        <div class="tau-link-actions tau-existing-share">\n            <a class="tau-remove i-role-remove-share" data-key="'+(null==(__t=key)?"":__t)+'" data-share-type="'+(null==(__t=share.shareType)?"":__t)+'" data-share-id="'+(null==(__t=share.id)?"":__t)+'">Remove</a>\n            <span class="tau-open">Copy link or <a target="_blank" href="'+(null==(__t=share.url)?"":__t)+'">Open the page</a></span>\n        </div>\n    '),__p+="\n    <div class=\"tau-note\">There's no need to grant permissions for that, so don't give this link to bad guys. The\n        snapshot will refresh every two minutes with the card, zoom and focus currently applied to this view.\n    </div>\n\n    ",share||(__p+='\n        <div class="shareboard__mashupinput">\n            <label><input type="checkbox" name="useContact" ',isUseContactChecked&&(__p+="checked "),__p+="/> Show my contact button on shared view</label>\n        </div>\n    "),__p+='\n\n</div>\n\n<div class="tau-distinct">\n    <div class="tau-actions"><a class="tau-board-shares-manage i-role-manage-shares">Manage your public views</a></div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="tau-share-content">\n    <h3>Shared views</h3>\n    <ul class="tau-boards-list">\n        ',shares.forEach(function(t){__p+='\n            <li>\n                <a href="'+(null==(__t=t.url)?"":__t)+'" class="tau-board-item" target="_blank" title="'+(null==(__t=t.title)?"":__t)+'">\n                    <span class="tau-board-name">'+(null==(__t=t.title)?"":__t)+'</span>\n                </a>\n                <a class="tau-remove i-role-remove-share" data-key="'+(null==(__t=t.key)?"":__t)+'"\n                   data-share-type="'+(null==(__t=t.shareType)?"":__t)+'" data-share-id="'+(null==(__t=t.id)?"":__t)+'">Remove</a>\n            </li>\n        '}),__p+="\n        ",0==shares.length&&(__p+="\n            <li>You have no shared views</li>\n        "),__p+='\n    </ul>\n</div>\n\n<div class="tau-distinct">\n    <div class="tau-actions"><a class="tau-board-shares-main i-role-current-share">Share View Menu</a></div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="tau-board-actions-item share-board-action shareboard">\n   <span class="share-board">\n       <div class="tau-inline-group">\n           <div>\n               <button type="button" class="tau-btn tau-share tau-share-board-button tau-board-customize-beta i-role-share-board">\n                   '+(null==(__t=title)?"":__t)+'\n               </button>\n               </div>\n       </div>\n    </span>\n    <div class="tau-txt">Share the view with the whole world.</div>\n</div>\n\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="board-actions__item">\n    <div class="board-actions__action i-role-share-board" title="Share the view with the whole world">\n        <span class="board-actions__item__text">'+(null==(__t=title)?"":__t)+"</span>\n    </div>\n</div>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<button type="button" style="margin-left: 10px;" class="tau-btn tau-share tau-share-board-button tau-board-customize-beta i-role-share-board">\n   '+(null==(__t=title)?"":__t)+"\n</button>\n";return __p}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_13__},function(t,e,n){var a=n(15);"string"==typeof a&&(a=[[t.id,a,""]]);n(17)(a,{});a.locals&&(t.exports=a.locals)},function(t,e,n){e=t.exports=n(16)(),e.push([t.id,".tau-share-board-bubble .tau-boards-list .tau-remove,.tau-share-board-bubble .tau-link-actions .tau-remove{float:right}.tau-chart-tooltip .tau-bubble__inner{min-width:inherit;font-family:OpenSans;font-size:.917em;padding:3px 6px}.tau-bubble .tau-distinct{position:relative;background-color:#FAFBFE;border-top:1px solid #C3CED9}.tau-bubble .tau-distinct:before{content:'';position:absolute;top:0;left:0;right:0;height:1px;display:block;background-color:#DFE4EB}.tau-share-board-bubble .tau-txt{font-size:13px}.tau-share-board-bubble .tau-bubble__inner{width:280px;font-size:13px;z-index:1000}.tau-share-board-bubble .tau-share-content{padding:10px}.tau-share-board-bubble .tau-share-content .tau-txt{display:inline-block;vertical-align:middle;margin-left:6px}.tau-share-board-bubble .tau-share-content .tau-note{color:#728397;padding-top:8px;font-size:11px}.tau-share-board-bubble .tau-distinct{padding:10px}.tau-share-board-bubble .tau-distinct .tau-actions{text-align:center;padding-bottom:3px}.tau-share-board-bubble .tau-actions a{text-decoration:none;color:#728397;border-bottom:dashed 1px #728397;display:inline-block;line-height:13px}.tau-share-board-bubble .tau-share-content .tau-in-text{width:100%;height:92px;color:#000;resize:none;overflow:hidden}.tau-share-board-bubble .tau-link-actions{overflow:hidden;padding-top:8px}.tau-share-board-bubble .tau-remove{color:#C33}.tau-share-board-bubble a{color:#2e94e5}.tau-share-board-bubble a:hover{text-decoration:none}.tau-share-board-bubble h3{color:#A3B1BF;font-size:13px;line-height:13px;text-transform:uppercase;margin:0}.tau-share-board-bubble .tau-boards-list{margin:0;padding:5px 0 0;list-style:none}.tau-share-board-bubble .tau-boards-list li{padding:4px 0;overflow:hidden}.tau-share-board-bubble .tau-boards-list .tau-board-item{float:left;padding-left:23px;position:relative}.tau-share-board-bubble .tau-boards-list .tau-board-item:before{content:'';display:block;position:absolute;top:2px;left:0;height:13px;width:16px}.tau-share-board-bubble .tau-boards-list .tau-board-item .tau-board-name{display:block;max-width:170px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.tau-share-board-bubble a{cursor:pointer;text-decoration:underline}.shareboard__mashupinput{margin-top:8px;cursor:pointer}.tau-share-board-bubble .tau-share-content__control{align-items:center;display:inline-flex;margin-right:2px;vertical-align:middle}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(a[o]=!0)}for(r=0;r<e.length;r++){var i=e[r];"number"==typeof i[0]&&a[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),t.push(i))}},t}},function(t,e,n){function a(t,e){for(var n=0;n<t.length;n++){var a=t[n],r=c[a.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](a.parts[o]);for(;o<a.parts.length;o++)r.parts.push(u(a.parts[o],e))}else{for(var i=[],o=0;o<a.parts.length;o++)i.push(u(a.parts[o],e));c[a.id]={id:a.id,refs:1,parts:i}}}}function r(t){for(var e=[],n={},a=0;a<t.length;a++){var r=t[a],o=r[0],i=r[1],u=r[2],s=r[3],l={css:i,media:u,sourceMap:s};n[o]?n[o].parts.push(l):e.push(n[o]={id:o,parts:[l]})}return e}function o(){var t=document.createElement("style"),e=f();return t.type="text/css",e.appendChild(t),t}function i(){var t=document.createElement("link"),e=f();return t.rel="stylesheet",e.appendChild(t),t}function u(t,e){var n,a,r;if(e.singleton){var u=_++;n=b||(b=o()),a=s.bind(null,n,u,!1),r=s.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=i(),a=d.bind(null,n),r=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=o(),a=l.bind(null,n),r=function(){n.parentNode.removeChild(n)});return a(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;a(t=e)}else r()}}function s(t,e,n,a){var r=n?"":a.css;if(t.styleSheet)t.styleSheet.cssText=v(e,r);else{var o=document.createTextNode(r),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(o,i[e]):t.appendChild(o)}}function l(t,e){var n=e.css,a=e.media;e.sourceMap;if(a&&t.setAttribute("media",a),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function d(t,e){var n=e.css,a=(e.media,e.sourceMap);a&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var r=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}var c={},p=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},h=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),f=p(function(){return document.head||document.getElementsByTagName("head")[0]}),b=null,_=0;t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=h());var n=r(t);return a(n,e),function(t){for(var o=[],i=0;i<n.length;i++){var u=n[i],s=c[u.id];s.refs--,o.push(s)}if(t){var l=r(t);a(l,e)}for(var i=0;i<o.length;i++){var s=o[i];if(0===s.refs){for(var d=0;d<s.parts.length;d++)s.parts[d]();delete c[s.id]}}}};var v=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()}])})}();